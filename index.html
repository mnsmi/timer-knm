<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Timer voor Koelewijn</title>
<link href="https://fonts.googleapis.com/css2?family=Ubuntu" rel="stylesheet">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<link href="style.css" rel="stylesheet">
<link rel="icon" href="favicon_timer_knm.png">
</head>

<body>
<div class="timer-container">
    <h1 id="time">00:00</h1>

    <div class="time-inputs">
        <input type="number" id="minutes" placeholder="Min" min="0">
        <input type="number" id="seconds" placeholder="Sec" min="0" max="59">
    </div>

    <div class="button-row">
        <button id="start">
            <span class="material-icons">play_arrow</span>
        </button>

        <button id="pause">
            <span class="material-icons">pause</span>
        </button>

        <button id="reset">
            <span class="material-icons">restart_alt</span>
        </button>

        <button id="fullscreen">
            <span class="material-icons">fullscreen</span>
        </button>
    </div>
    <p>~ Made with ❤️ ~</p>
</div>

<script>
let timer;
let totalSeconds = 0;
let remainingSeconds = 0;
let isRunning = false;
let currentAudio = null;

const alarms = [
    "sounds/narc.mp3",
    "sounds/jttw.mp3",
    "sounds/inst.mp3",
    "sounds/harm.mp3",
    "sounds/begi.mp3"
];

const backgrounds = [
    "backgrounds/1.png",
    "backgrounds/2.png",
    "backgrounds/3.png",
    "backgrounds/4.png",
    "backgrounds/5.png",
    "backgrounds/6.png",
    "backgrounds/7.png"
];

const timeDisplay = document.getElementById("time");
const minutesInput = document.getElementById("minutes");
const secondsInput = document.getElementById("seconds");
const fullscreenBtn = document.getElementById("fullscreen");

function setRandomBackground() {
    const randomIndex = Math.floor(Math.random() * backgrounds.length);
    document.body.style.background =
        `url('${backgrounds[randomIndex]}') no-repeat center center / cover`;
}
setRandomBackground();

setInterval(setRandomBackground, 60000);

secondsInput.addEventListener("input", () => {
    let secs = parseInt(secondsInput.value) || 0;
    let mins = parseInt(minutesInput.value) || 0;

    if (secs >= 60) {
        mins += Math.floor(secs / 60);
        secs = secs % 60;
    }

    if (secs < 0) secs = 0;

    minutesInput.value = mins;
    secondsInput.value = secs;
});

function updateDisplay(seconds) {
    const mins = Math.floor(seconds / 60);
    const secs = seconds % 60;

    timeDisplay.textContent =
        `${mins.toString().padStart(2, "0")}:${secs.toString().padStart(2, "0")}`;
}

function startTimer() {
    if (isRunning) return;

    if (remainingSeconds === 0) {
        const mins = parseInt(minutesInput.value) || 0;
        const secs = parseInt(secondsInput.value) || 0;

        totalSeconds = mins * 60 + secs;
        remainingSeconds = totalSeconds;

        if (totalSeconds <= 0) return;
    }

    isRunning = true;

    timer = setInterval(() => {
        if (remainingSeconds <= 0) {
            clearInterval(timer);
            isRunning = false;
            playRandomAlarm();
            remainingSeconds = 0;
            updateDisplay(remainingSeconds);
            return;
        }

        remainingSeconds--;
        updateDisplay(remainingSeconds);

    }, 1000);
}

function pauseTimer() {
    clearInterval(timer);
    isRunning = false;

    if (currentAudio) {
        currentAudio.pause();
        currentAudio.currentTime = 0;
    }
}

function resetTimer() {
    clearInterval(timer);
    isRunning = false;

    remainingSeconds = totalSeconds = 0;
    updateDisplay(0);

    minutesInput.value = "";
    secondsInput.value = "";

    if (currentAudio) {
        currentAudio.pause();
        currentAudio.currentTime = 0;
    }
}

function playRandomAlarm() {
    const randomIndex = Math.floor(Math.random() * alarms.length);
    currentAudio = new Audio(alarms[randomIndex]);
    currentAudio.play();
}

function toggleFullscreen() {
    if (!document.fullscreenElement) {
        document.documentElement.requestFullscreen();
        fullscreenBtn.firstElementChild.textContent = "fullscreen_exit";
    } else {
        document.exitFullscreen();
        fullscreenBtn.firstElementChild.textContent = "fullscreen";
    }
}

document.getElementById("start").addEventListener("click", startTimer);
document.getElementById("pause").addEventListener("click", pauseTimer);
document.getElementById("reset").addEventListener("click", resetTimer);
fullscreenBtn.addEventListener("click", toggleFullscreen);
</script>

</body>
</html>